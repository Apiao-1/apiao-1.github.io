<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Kaggle NFL Big Data Bowl Resume"><meta name="keywords" content="Kaggle"><meta name="author" content="Apiao"><meta name="copyright" content="Apiao"><title>Kaggle NFL Big Data Bowl Resume | è¿‡å®¢åˆ«å¢…</title><link rel="shortcut icon" href="https://apiao-1258505467.cos.ap-chengdu.myqcloud.com/blog_pic/css_img/favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?9e24343494f127f2cc9e8c004fb20cbd";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#æ¦‚è¿°"><span class="toc-number">1.</span> <span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DATA"><span class="toc-number">2.</span> <span class="toc-text">DATA</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#éš¾ç‚¹"><span class="toc-number">2.0.1.</span> <span class="toc-text">éš¾ç‚¹</span></a></li></ol></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#EDA"><span class="toc-number">3.</span> <span class="toc-text">EDA</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#model"><span class="toc-number">4.</span> <span class="toc-text">model</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#trick"><span class="toc-number">5.</span> <span class="toc-text">trick</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#What-didnâ€™t-work"><span class="toc-number">6.</span> <span class="toc-text">What didnâ€™t work</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Thinking"><span class="toc-number">7.</span> <span class="toc-text">Thinking</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#å† å†›æ–¹æ¡ˆå°ç»“"><span class="toc-number">8.</span> <span class="toc-text">å† å†›æ–¹æ¡ˆå°ç»“</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æ¨¡å‹ç»“æ„"><span class="toc-number">8.0.1.</span> <span class="toc-text">æ¨¡å‹ç»“æ„</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ•°æ®å¢å¼ºå’ŒTTA"><span class="toc-number">8.0.2.</span> <span class="toc-text">æ•°æ®å¢å¼ºå’ŒTTA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ä»£ç ä¼˜åŒ–"><span class="toc-number">8.0.3.</span> <span class="toc-text">ä»£ç ä¼˜åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CNNä¼ªä»£ç "><span class="toc-number">8.0.4.</span> <span class="toc-text">CNNä¼ªä»£ç </span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-16æ›´æ–°"><span class="toc-number">9.</span> <span class="toc-text">1.16æ›´æ–°</span></a></li></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://apiao-1258505467.cos.ap-chengdu.myqcloud.com/blog_pic/css_img/profile1.jpg"></div><div class="author-info__name text-center">Apiao</div><div class="author-info__description text-center"></div><div class="follow-button"><a href="https://github.com/Apiao-1">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">33</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">18</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">2</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" href="https://yisaer.github.io/">Yisa</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://apiao-1258505467.cos.ap-chengdu.myqcloud.com/blog_pic/css_img/article3.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Coding Life</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a><a class="site-page" href="/">Home</a><a class="site-page" href="/about">About</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">Kaggle NFL Big Data Bowl Resume</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-01-09</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/æŠ€æœ¯ç±»/">æŠ€æœ¯ç±»</a><div class="post-meta-wordcount"><span>Word count: </span><span class="word-count">5k</span><span class="post-meta__separator">|</span><span>Reading time: 19 min</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>å…ˆè´´ä¸Šæ¯”èµ›åœ°å€ï¼š<a href="https://www.kaggle.com/c/nfl-big-data-bowl-2020" target="_blank" rel="noopener">https://www.kaggle.com/c/nfl-big-data-bowl-2020</a></p>
<p>æ¯”èµ›å¤§æ„æ˜¯åœ¨ç¾å¼æ©„æ¦„çƒæ¯”èµ›ä¸­ğŸ‰ï¼Œéœ€è¦å¯¹è¿›æ”»æ–¹æ¯ä¸€è½®è·‘åŠ¨æ¨è¿›çš„ç æ•°è¿›è¡Œé¢„æµ‹ï¼Œæ¯”è¾ƒåœ¨æ„çš„æ˜¯è¿™ä¸ªé—®é¢˜çš„è¯„ä»·æŒ‡æ ‡å¾ˆå¥‡ç‰¹ï¼Œç”¨åˆ°äº†åˆ†çº§æ¦‚ç‡å‡½æ•°ï¼Œå…·ä½“è§<a href="https://baike.baidu.com/item/%E8%BF%9E%E7%BB%AD%E5%88%86%E7%BA%A7%E6%A6%82%E7%8E%87%E8%AF%84%E5%88%86/23690953?fr=aladdin" target="_blank" rel="noopener">è¿ç»­åˆ†çº§æ¦‚ç‡è¯„åˆ†</a>ï¼Œç›¸åº”çš„ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥æŠŠå®ƒå¤„ç†æˆ199ä¸ªåˆ†ç±»çš„å¤šåˆ†ç±»é—®é¢˜ï¼Œä¹Ÿå¯ä»¥å¤„ç†æˆå›å½’é—®é¢˜ï¼Œè¿™é‡Œæ“ä½œçš„ç©ºé—´å°±å¾ˆå¤§äº†ã€‚åŒæ—¶æœ€åçš„Bæ¦œæ¥æºäº12æœˆåˆ°1æœˆå³å°†ä¸¾åŠçš„æ¯”èµ›ï¼Œæ˜¯æœªæ¥çš„æ•°æ®ï¼Œè¿™å¸¦æ¥äº†æ›´å¤§çš„æŒ‘æˆ˜ã€‚</p>
<p>æ­¤å¤–è¯¥èµ›é¢˜æ˜¯kernal basedï¼Œé€‰æ‰‹æœ€åæäº¤çš„æ˜¯ä¸€ä¸ª.ipynbçš„å¯è¿è¡Œjupyteræ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯æ¬¡é¢„æµ‹ä¼šé‡æ–°è·‘è¿™æ®µä»£ç ï¼Œè®­ç»ƒæ–°çš„æ¨¡å‹å¹¶è¿›è¡Œé¢„æµ‹ï¼Œè€Œæ¯”èµ›å¯¹åº”çš„è®­ç»ƒé›†ä¹Ÿä¼šéšç€æ¯”èµ›çš„è¿›è¡Œï¼ŒBæ¦œçš„æ›´æ–°è€Œæ›´æ–°ï¼Œä¼šæŠŠæ–°çš„æ¯”èµ›æ•°æ®åŠ å…¥åˆ°è®­ç»ƒé›†ä¹‹ä¸­ï¼Œè¿™å¸¦æ¥çš„æŒ‘æˆ˜æ˜¯éœ€è¦æˆ‘ä»¬ä¸ºå¢é‡çš„æ•°æ®é¢„ç•™å¥½ç©ºé—´å’Œæ—¶é—´å¤æ‚åº¦ï¼ˆå•ä¸ªkernalå¯æ‰§è¡Œæ—¶é—´éœ€å°äº4å°æ—¶ï¼Œæœ€å¤§å†…å­˜16Gï¼‰</p>
<hr>
<h1 id="DATA"><a href="#DATA" class="headerlink" title="DATA"></a>DATA</h1><p>å…ˆé™„ä¸ŠåŸå§‹æ•°æ®çš„æ•°æ®è¯å…¸ï¼Œå¯¹äºç¾å¼æ©„æ¦„çƒä¸ç†Ÿæ‚‰çš„å¯ä»¥å‚è€ƒ <a href="https://baike.baidu.com/item/%E7%BE%8E%E5%BC%8F%E6%A9%84%E6%A6%84%E7%90%83/934574?fr=aladdin" target="_blank" rel="noopener">ç¾å¼æ©„æ¦„çƒ</a></p>
<p>æ•°æ®æºï¼š<a href="https://www.kaggle.com/c/nfl-big-data-bowl-2020/data" target="_blank" rel="noopener">https://www.kaggle.com/c/nfl-big-data-bowl-2020/data</a></p>
<ul>
<li><p><code>GameId</code> - a unique game identifier æ¯”èµ›ID</p>
</li>
<li><p><code>PlayId</code> - a unique play identifier ä¸€åœºæ¯”èµ›ä¸­æ‰€æœ‰playçš„IDï¼ˆæ¯æ¬¡playéƒ½æœ‰å¯èƒ½å¾—åˆ†ï¼‰</p>
</li>
<li><p><code>Team</code> - home or away é˜Ÿå</p>
</li>
<li><p><code>X</code> - player position along the long axis of the field. See figure below.</p>
</li>
<li><p><code>Y</code> - player position along the short axis of the field. See figure below.<br><img src="https://www.googleapis.com/download/storage/v1/b/kaggle-user-content/o/inbox%2F3258%2F7542d363a19fa3eea77708e6b90bc420%2FFig1.png?generation=1570562067917019&alt=media" alt="img"></p>
<blockquote>
<p>NFLå’ŒNCAAä½¿ç”¨çš„æ ‡å‡†çƒåœºæ˜¯ä¸€ä¸ªé•¿360è‹±å°ºï¼ˆ120ç æˆ–109.7ç±³ï¼‰ã€å®½160è‹±å°ºï¼ˆ53.33ç æˆ–48.8ç±³ï¼‰çš„é•¿æ–¹å½¢è‰åªï¼ˆæœ‰äº›å®¤å†…èµ›ä¼šä½¿ç”¨ä»¿è‰åœ°æ¯¯ï¼‰ï¼Œè¾ƒé•¿çš„è¾¹ç•Œç§°ä¸ºè¾¹çº¿ï¼ˆsidelineï¼‰ï¼Œè¾ƒçŸ­çš„è¾¹ç•Œç§°ä¸ºç«¯çº¿ï¼ˆend lineï¼‰ã€‚ç«¯çº¿å‰çš„æ ‡ç¤ºçº¿ç§°ä¸ºå¾—åˆ†çº¿ï¼ˆgoal lineï¼‰ï¼Œçƒåœºæ¯ä¾§ç«¯çº¿ä¸å¾—åˆ†çº¿ä¹‹é—´æœ‰ä¸€ä¸ªçºµæ·±10ç ï¼ˆ9.1ç±³ï¼‰çš„å¾—åˆ†åŒºå«åšç«¯åŒºï¼ˆend zoneï¼Œä¹Ÿç§°è¾¾é˜µåŒºï¼‰ï¼Œç«¯åŒºçš„å››è§’å„æœ‰ä¸€ä¸ªçº¦æœ‰1è‹±å°ºé•¿çš„æ©™è‰²é•¿æ–¹ä½“æ ‡æŸ±ï¼ˆpylonï¼‰ã€‚ä¸¤ä¾§å¾—åˆ†çº¿ç›¸è·100ç ï¼ˆ91.44ç±³ï¼‰ï¼Œä¹‹é—´çš„åŒºåŸŸä¹Ÿå°±æ˜¯æ¯”èµ›åŒºï¼ˆplaying fieldï¼‰ã€‚æ¯”èµ›åŒºä¸Šè·ç¦»å¾—åˆ†çº¿æ¯5ç ï¼ˆ4.6ç±³ï¼‰è·ç¦»æ ‡åˆ’ä¸€æ¡ç çº¿ï¼ˆyard lineï¼Œæˆ–ç§°5ç çº¿ï¼‰ï¼Œæ¯10ç æ ‡ç¤ºæ•°å­—ï¼Œç›´åˆ°50ç çº¿åˆ°è¾¾ä¸­åœºï¼ˆmidfieldï¼‰ã€‚åœ¨çƒåœºä¸­é—´å’Œä¸¤ä¾§ä¸è¾¹çº¿å¹³è¡Œæ’åˆ—åˆ’æœ‰æ¨ªå‘çš„çŸ­æ ‡ç¤ºçº¿ï¼Œç§°ä¸ºç æ ‡ï¼ˆhash marksï¼Œæˆ–ç§°æ•´ç çº¿ï¼‰ï¼Œå…¶ä¸­æ¥è¿‘è¾¹çº¿çš„ç æ ‡çº¿ç§°ä¸ºç•Œå†…çº¿ï¼ˆinbounds lineï¼‰ã€‚ä»»ä½•çƒå‘˜éƒ½å¿…é¡»åœ¨ç æ ‡çº¿ä¸Šæˆ–ä¹‹é—´è¿›è¡Œå‘çƒã€‚</p>
</blockquote>
</li>
<li><p><code>S</code> - speed in yards/second æ­¤æ—¶çš„é€Ÿåº¦</p>
</li>
<li><p><code>A</code> - acceleration in yards/second^2 åŠ é€Ÿåº¦</p>
</li>
<li><p><code>Dis</code> - distance traveled from prior time point, in yards</p>
</li>
<li><p><code>Orientation</code> - orientation of player (deg) ç©å®¶é¢å¯¹çš„æ–¹å‘</p>
</li>
<li><p><code>Dir</code> - angle of player motion (deg) ç©å®¶ç§»åŠ¨çš„æ–¹å‘</p>
</li>
<li><p><img src="https://www.googleapis.com/download/storage/v1/b/kaggle-user-content/o/inbox%2F75976%2F277b02ac1a245d56362715d8a550fb74%2Forientation.png?generation=1571665174994396&alt=media" alt="img"></p>
</li>
<li><p><code>NflId</code> - a unique identifier of the player è¿åŠ¨å‘˜ID</p>
</li>
<li><p><code>DisplayName</code> - playerâ€™s name è¿åŠ¨å‘˜name</p>
</li>
<li><p><code>JerseyNumber</code> - jersey number è¿åŠ¨å‘˜å·ç </p>
</li>
<li><p><code>Season</code> - year of the season</p>
</li>
<li><p><code>YardLine</code> - the yard line of the line of scrimmage å‘çƒçš„ç çº¿</p>
</li>
<li><p><code>Quarter</code> - game quarter (1-5, 5 == overtime) æ¯”èµ›æ‰€å¤„çš„æ—¶é—´</p>
</li>
<li><p><code>GameClock</code> - time on the game clock </p>
</li>
<li><p><code>PossessionTeam</code> - team with possession å½“å‰æ‹¥æœ‰æ§çƒæƒçš„é˜Ÿä¼</p>
</li>
<li><p><code>Down</code> - the down (1-4)</p>
<blockquote>
<p>è¿›æ”»æ–¹æœ‰å››æ¬¡æœºä¼šå‘å‰æ–¹ï¼ˆé˜²å®ˆæ–¹çš„ç«¯åŒºï¼‰ç´¯è®¡æ¨è¿›10ç ï¼Œæ¯æ¬¡æœºä¼šç§°ä¸ºä¸€â€œ<strong>æ¡£</strong>â€ è¿›æ”»ï¼ˆdownï¼Œå³è¢«å¯¹æ–¹æ‹¦æˆªæ”¾å€’ä¸€æ¬¡çš„æœºä¼šï¼‰ã€‚å½“è¿›æ”»æ–¹æˆåŠŸçš„åœ¨å››æ¡£è¿›æ”»å†…æ¨è¿›äº†10ç ä»¥ä¸Šï¼Œä¾¿å¯è·å¾—æ–°çš„å››æ¡£è¿›æ”»æœºä¼šâ€”â€”ç§°ä¸ºè·å¾—æ–°çš„ â€œ<strong>é¦–æ¡£</strong>â€ï¼ˆ1st downï¼Œä¹Ÿç§°<strong>é¦–æ”»</strong>ï¼‰ã€‚é€šè¿‡ä¸æ–­è·å¾—æ–°çš„é¦–æ”»ï¼Œè¿›æ”»æ–¹å¯ä»¥è¿›è¡Œè¿ç»­çš„ç³»åˆ—è¿›æ”»å‘å‰ä¸æ–­æ¨è¿›ï¼Œç›´è‡³å¾—åˆ†ã€‚è€Œé˜²å®ˆæ–¹çš„ç›®çš„ä¹Ÿå¾ˆç®€å•â€”â€”å°±æ˜¯å°½å¯èƒ½é˜»æ­¢å¯¹æ–¹åœ¨å››æ¡£è¿›æ”»å†…æ¨è¿›è¶³å¤Ÿçš„è·ç¦»ï¼Œé€¼è¿«å…¶äº¤æ¢æ§çƒæƒã€‚</p>
</blockquote>
</li>
<li><p><code>Distance</code> - yards needed for a first down è·ç¦»æ–°çš„é¦–æ”»æ‰€éœ€è¦çš„ç æ•°</p>
</li>
<li><p><code>FieldPosition</code> - which side of the field the play is happening on playå‘ç”Ÿåœ¨å“ªä¸ªçƒé˜Ÿçš„åŠåœº</p>
</li>
<li><p><code>HomeScoreBeforePlay</code> - home team score before play started ä¸»é˜Ÿå·²ç»è·å¾—çš„æ¯”åˆ†</p>
</li>
<li><p><code>VisitorScoreBeforePlay</code> - visitor team score before play started å®¢é˜Ÿå·²ç»è·å¾—çš„æ¯”åˆ†</p>
</li>
<li><p><code>NflIdRusher</code> - the <code>NflId</code> of the rushing player è¿›æ”»æ–¹æŒçƒé€‰æ‰‹ID</p>
</li>
<li><p><code>OffenseFormation</code> - offense formation</p>
</li>
<li><p><code>OffensePersonnel</code> - offensive team positional grouping è¿›æ”»é˜Ÿå‘˜</p>
</li>
<li><p><code>DefendersInTheBox</code> - number of defenders lined up near the line of scrimmage, spanning the width of the offensive line</p>
</li>
<li><p><code>DefensePersonnel</code> - defensive team positional grouping é˜²å®ˆé˜Ÿå‘˜</p>
</li>
<li><p><code>PlayDirection</code> - direction the play is headed</p>
</li>
<li><p><code>TimeHandoff</code> - UTC time of the  handoff ä¼ çƒæ—¶é—´</p>
</li>
<li><p><code>TimeSnap</code> - UTC time of the snap å‘çƒçš„æ—¶é—´</p>
</li>
<li><p><strong><code>Yards</code> - the yardage gained on the play (you are predicting this)</strong> å¾—åˆ†ï¼Œå³æœ€åé¢„æµ‹çš„y</p>
</li>
<li><p><code>PlayerHeight</code> - player height (ft-in)</p>
</li>
<li><p><code>PlayerWeight</code> - player weight (lbs)</p>
</li>
<li><p><code>PlayerBirthDate</code> - birth date (mm/dd/yyyy)</p>
</li>
<li><p><code>PlayerCollegeName</code> - where the player attended college</p>
</li>
<li><p><code>Position</code> - the playerâ€™s position (the specific role on the field that they typically play)</p>
</li>
<li><p><code>HomeTeamAbbr</code> - home team abbreviation ä¸»é˜Ÿç¼©å†™</p>
</li>
<li><p><code>VisitorTeamAbbr</code> - visitor team abbreviation</p>
</li>
<li><p><code>Week</code> - week into the season èµ›å­£çš„ç¬¬å‡ å‘¨</p>
</li>
<li><p><code>Stadium</code> - stadium where the game is being played</p>
</li>
<li><p><code>Location</code> - city where the game is being player</p>
</li>
<li><p><code>StadiumType</code> - description of the stadium environment ä½“è‚²é¦†ç±»å‹</p>
</li>
<li><p><code>Turf</code> - description of the field surface åœºåœ°ç±»å‹</p>
</li>
<li><p><code>GameWeather</code> - description of the game weather</p>
</li>
<li><p><code>Temperature</code> - temperature (deg F)</p>
</li>
<li><p><code>Humidity</code> - humidity æ¹¿åº¦</p>
</li>
<li><p><code>WindSpeed</code> - wind speed in miles/hour</p>
</li>
<li><p><code>WindDirection</code> - wind direction</p>
</li>
</ul>
<hr>
<h3 id="éš¾ç‚¹"><a href="#éš¾ç‚¹" class="headerlink" title="éš¾ç‚¹"></a>éš¾ç‚¹</h3><ol>
<li><p>playçš„ç‰¹å¾å’Œæ¯ä¸ªçƒå‘˜çš„ç‰¹å¾å¦‚ä½•ç»Ÿä¸€è¿›æ¨¡å‹ä¸­</p>
<ol>
<li><p>NNå¯ä»¥å¯¹ä¸åŒsize çš„ç‰¹å¾è¿›è¡Œå¤„ç†,å¯ä»¥åˆ†åˆ«å°†çƒå‘˜ç‰¹å¾è¿›è¡Œembeding</p>
</li>
<li><p>playçš„ç‰¹å¾ä¸­åŠ å…¥rusherçš„ç‰¹å¾ä½œä¸ºçƒå‘˜ç‰¹å¾</p>
</li>
<li><p>playçš„ç‰¹å¾ä¸­åŠ å…¥æ¯ä¸€ä¸ªçƒå‘˜çš„æ‰€æœ‰ç‰¹å¾ï¼Œä¸å»ºè®®ï¼ˆçƒå‘˜ç‰¹å¾å¤šçš„æ—¶å€™*22 å¼•å…¥å¤§é‡å™ªå£°ï¼‰ï¼Œæ›´å¥½çš„æ–¹æ¡ˆæ˜¯å¯¹çƒå‘˜è¿›è¡Œèšåˆï¼ˆaggï¼‰å½¢æˆç‰¹å¾</p>
</li>
</ol>
</li>
<li><p>å¤šåˆ†ç±»é—®é¢˜å¦‚ä½•å½¢æˆè¯„ä»·æŒ‡æ ‡</p>
<ol>
<li><p>è¿ç»­åˆ†çº§æ¦‚ç‡è¯„åˆ†ï¼ˆContinuous Ranked Probability Score, CRPSï¼‰ï¼ŒæŒ‰CRPSè¯„ä»·æ¦‚ç‡æ¨¡å‹æ‰€å¾—çš„ï¼ˆä¼˜åŠ£ï¼‰ç»“æœä¸æŒ‰MAEè¯„ä»·æ¦‚ç‡æ¨¡å‹çš„æ•°å­¦æœŸæœ›æ‰€å¾—çš„ç»“æœç­‰ä»·ï¼Œtrain modelæ—¶ç”¨mae</p>
</li>
<li><blockquote>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯sklearnä¸­çš„MAEæ˜¯è´Ÿå€¼ï¼ŒåŸå› ï¼šå› ä¸ºæœ‰äº›scoreæ˜¯è¶Šå¤§è¶Šå¥½ï¼Œæ¯”å¦‚roc_auc,ä½†æœ‰äº›è¶Šå°è¶Šå¥½æ¯”å¦‚å„ç§lossï¼Œä¸ºäº†ç»Ÿä¸€ï¼Œsklearnä¸ºæœ€å°åŒ–çš„å€¼åŠ äº†è´Ÿå·è½¬åŒ–ä¸ºæœ€å¤§åŒ–çš„é—®é¢˜ï¼Œè¿™é‡Œéœ€è¦ç›¸åº”åœ°ä¿®æ”¹ç½‘æ ¼é‡Œçš„åˆå§‹åŒ–å‚æ•°</p>
</blockquote>
</li>
</ol>
</li>
<li><p>æ•´ä¸ªæ•°æ®é›†è™½ç„¶æœ‰äº”åå‡ ä¸‡ï¼Œä½†æ¯åœºplayéƒ½å¯¹åº”äº†22ä¸ªçƒå‘˜ï¼Œæ•´ç†ä¸‹æ¥playçš„æ•°æ®é‡åªæœ‰23171 * 72ï¼Œä¼šé€ æˆè¿‡æ‹Ÿåˆï¼Œæ€ä¹ˆé¿å…</p>
</li>
<li><p>é¢„æµ‹ä¸Šçš„éš¾ç‚¹ï¼Œæœ€åçš„Bæ¦œè®­ç»ƒé›†ä¼šåŠ å…¥æœªæ¥ä¸€ä¸ªæœˆæ–°çš„æ¯”èµ›æ•°æ®ï¼Œkernal basedæ¯”èµ›éœ€è¦åšå¥½æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦çš„æ§åˆ¶</p>
</li>
<li><p>å…³äºè¿åŠ¨å‘˜çš„è¿åŠ¨æ–¹å‘ï¼Œè¿›æ”»æ–¹å¯èƒ½å‘å·¦å¯èƒ½å‘å³ï¼Œæ­¤æ—¶éœ€è¦å¯¹yardè¿›è¡Œè½¬æ¢ï¼Œå¤„ç†æ—¶æœ‰ä¸ªtrickæ˜¯å°†X,y,è§’åº¦éƒ½è¿›è¡Œç¿»è½¬ï¼Œä¿è¯è¿›æ”»æ–¹çš„æ–¹å‘å§‹ç»ˆæ˜¯ä¸€è‡´çš„ä»¥ä¾¿äºç‰¹å¾çš„å¤„ç†</p>
</li>
</ol>
<h1 id="EDA"><a href="#EDA" class="headerlink" title="EDA"></a>EDA</h1><p>æ¢³ç†ä¸€ä¸‹é—®é¢˜å…¶å®å°±æ˜¯ï¼Œä¸€ä¸ªrusherï¼Œ10ä¸ªé˜Ÿå‹ï¼Œ11ä¸ªé˜²å®ˆæ–¹çš„ç«èµ›ï¼Œrusherä¼šå°½ä¸€åˆ‡åŠªåŠ›å†²ç ´é˜²å®ˆæ–¹é˜²çº¿ï¼Œå¯¹åº”åœ°é˜²å®ˆæ–¹ä¼šä¸é¡¾ä¸€åˆ‡è·‘å‘rusherä»¥é˜»æ­¢ä»–ï¼Œé˜Ÿå‹ä¹Ÿéœ€è¦è·‘å‘rusherä»¥ååŠ©è¿›æ”»ï¼Œå› æ­¤ä¸éš¾å‘ç°è·ç¦»çš„ç‰¹å¾ä¼šå¾ˆé‡è¦ã€‚æ•…æˆ‘ä»¬çš„ç‰¹å¾å·¥ç¨‹ä¸»è¦å›´ç»•è¿™ä¸€å˜é‡å±•å¼€ï¼š</p>
<ol>
<li>å°†è¿›æ”»æ–¹å‘è¿›è¡Œç»Ÿä¸€ï¼Œè½¬æ¢å¯¹åº”çš„yardlineã€xã€yã€orientationã€direction</li>
<li>æ¯ä¸ªplayåŠ å…¥rusherçš„ç›¸å…³ç‰¹å¾</li>
<li>å¢åŠ çƒå‘˜ç‰¹å¾çš„ç»Ÿè®¡ç‰¹å¾agg<br> <code>min&#39;, &#39;max&#39;, &#39;mean&#39;, &#39;std&#39;, &#39;skew&#39;, &#39;median&#39;, q80, q30, pd.DataFrame.kurt, &#39;mad&#39;,np.ptp</code></li>
<li>å°†çƒå‘˜åˆ†ä¸ºè¿›æ”»æ–¹å’Œé˜²å®ˆæ–¹ï¼Œåˆ†åˆ«è¿›è¡Œè·ç¦»rusherè·ç¦»ã€xã€yçš„èšåˆç»Ÿè®¡</li>
<li>å°è¯•ç©¿è¶Šç‰¹å¾ï¼šè®¡ç®—é˜Ÿä¼å†å²åœºå‡æ¨è¿›ï¼Œååœ¨lbä¸Šæœªæœ‰æ˜æ˜¾æé«˜ï¼Œæ”¾å¼ƒï¼ˆè€ƒè™‘æ•ˆæœä¸å¥½çš„åŸå› ï¼š1.æµ‹è¯•é›†é˜Ÿä¼å’Œè®­ç»ƒé›†å¯èƒ½ä¸åŒï¼Œæœ‰ç¼ºå¤±å€¼ï¼›2.åœºå‡æ¨è¿›å—è¿›æ”»æ–¹å’Œé˜²å®ˆæ–¹å…±åŒå½±å“ï¼Œä»…ä»…æ ¹æ®è¿›æ”»æ–¹è®¡ç®—çš„æ¨è¿›è·ç¦»ä¼šæœ‰å¤±çœŸï¼‰</li>
</ol>
<blockquote>
<p>ç¬¬ä¸€åçš„ç‰¹å¾æ€è·¯æ€»ç»“åœ°æ›´å¥½ï¼Œè§<a href="https://www.kaggle.com/c/nfl-big-data-bowl-2020/discussion/119400#latest-685747" target="_blank" rel="noopener">https://www.kaggle.com/c/nfl-big-data-bowl-2020/discussion/119400#latest-685747</a></p>
</blockquote>
<h1 id="model"><a href="#model" class="headerlink" title="model"></a>model</h1><ol>
<li><p>NNï¼š</p>
<ol>
<li><p>åˆ†åˆ«å¤„ç†categoryå’Œdenseçš„NNï¼Œæ•ˆæœä¸€èˆ¬<img src="https://apiao-1258505467.cos.ap-chengdu.myqcloud.com/blog_pic/kaggle/NFL/NN_struct.png" alt="NN_struct" style="zoom: 50%;"></p>
</li>
<li><p>ç”¨æœ€ç®€å•çš„å…¨è¿æ¥çš„NN,è‡ªå®šä¹‰æŸå¤±å‡½æ•°ï¼Œé€šè¿‡early stoppingå’Œdropouté™ä½è¿‡æ‹Ÿåˆ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CRPSCallback</span><span class="params">(Callback)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, validation, predict_batch_size=<span class="number">20</span>, include_on_batch=False)</span>:</span></span><br><span class="line">        super(CRPSCallback, self).__init__()</span><br><span class="line">        self.validation = validation</span><br><span class="line">        self.predict_batch_size = predict_batch_size</span><br><span class="line">        self.include_on_batch = include_on_batch</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">on_batch_begin</span><span class="params">(self, batch, logs=&#123;&#125;)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">on_train_begin</span><span class="params">(self, logs=&#123;&#125;)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (<span class="string">'CRPS_score_val'</span> <span class="keyword">in</span> self.params[<span class="string">'metrics'</span>]):</span><br><span class="line">            self.params[<span class="string">'metrics'</span>].append(<span class="string">'CRPS_score_val'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">on_batch_end</span><span class="params">(self, batch, logs=&#123;&#125;)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> (self.include_on_batch):</span><br><span class="line">            logs[<span class="string">'CRPS_score_val'</span>] = float(<span class="string">'-inf'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">on_epoch_end</span><span class="params">(self, epoch, logs=&#123;&#125;)</span>:</span></span><br><span class="line">        logs[<span class="string">'CRPS_score_val'</span>] = float(<span class="string">'-inf'</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (self.validation):</span><br><span class="line">            X_valid, y_valid = self.validation[<span class="number">0</span>], self.validation[<span class="number">1</span>]</span><br><span class="line">            y_pred = self.model.predict(X_valid)</span><br><span class="line">            y_true = np.clip(np.cumsum(y_valid, axis=<span class="number">1</span>), <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">            y_pred = np.clip(np.cumsum(y_pred, axis=<span class="number">1</span>), <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">            val_s = ((y_true - y_pred) ** <span class="number">2</span>).sum(axis=<span class="number">1</span>).sum(axis=<span class="number">0</span>) / (<span class="number">199</span> * X_valid.shape[<span class="number">0</span>])</span><br><span class="line">            val_s = np.round(val_s, <span class="number">8</span>)</span><br><span class="line">            logs[<span class="string">'CRPS_score_val'</span>] = val_s</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_model</span><span class="params">(x_tr, y_tr, x_val, y_val)</span>:</span></span><br><span class="line">    inp = Input(shape=(x_tr.shape[<span class="number">1</span>],))</span><br><span class="line">    <span class="comment"># x = Dense(2048, input_dim=X.shape[1], activation='elu')(inp)</span></span><br><span class="line">    <span class="comment"># x = BatchNormalization()(x)</span></span><br><span class="line">    <span class="comment"># x = Dropout(0.5)(x)</span></span><br><span class="line">    <span class="comment"># x = Dense(1024, activation='elu')(x)</span></span><br><span class="line">    x = Dense(<span class="number">1024</span>, input_dim=X.shape[<span class="number">1</span>], activation=<span class="string">'elu'</span>)(inp)</span><br><span class="line">    x = BatchNormalization()(x)</span><br><span class="line">    x = Dropout(<span class="number">0.5</span>)(x)</span><br><span class="line">    x = Dense(<span class="number">512</span>, activation=<span class="string">'elu'</span>)(x)</span><br><span class="line">    x = BatchNormalization()(x)</span><br><span class="line">    x = Dropout(<span class="number">0.5</span>)(x)</span><br><span class="line">    x = Dense(<span class="number">256</span>, activation=<span class="string">'elu'</span>)(x)</span><br><span class="line">    x = BatchNormalization()(x)</span><br><span class="line">    x = Dropout(<span class="number">0.5</span>)(x)</span><br><span class="line">    <span class="keyword">if</span> classify_type &lt; <span class="number">128</span>:</span><br><span class="line">        x = Dense(<span class="number">256</span>, activation=<span class="string">'elu'</span>)(x)</span><br><span class="line">        x = BatchNormalization()(x)</span><br><span class="line">        x = Dropout(<span class="number">0.5</span>)(x)</span><br><span class="line"></span><br><span class="line">    out = Dense(classify_type, activation=<span class="string">'softmax'</span>)(x)</span><br><span class="line">    model = Model(inp, out)</span><br><span class="line">    optadam = Adam(lr=<span class="number">0.001</span>)</span><br><span class="line">    model.compile(optimizer=optadam, loss=<span class="string">'categorical_crossentropy'</span>, metrics=[])</span><br><span class="line"></span><br><span class="line">    es = EarlyStopping(monitor=<span class="string">'CRPS_score_val'</span>,</span><br><span class="line">                       mode=<span class="string">'min'</span>,</span><br><span class="line">                       restore_best_weights=<span class="literal">True</span>,</span><br><span class="line">                       verbose=<span class="literal">False</span>,</span><br><span class="line">                       patience=<span class="number">80</span>)</span><br><span class="line"></span><br><span class="line">    mc = ModelCheckpoint(<span class="string">'best_model.h5'</span>, monitor=<span class="string">'CRPS_score_val'</span>, mode=<span class="string">'min'</span>,</span><br><span class="line">                         save_best_only=<span class="literal">True</span>, verbose=<span class="literal">False</span>, save_weights_only=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    bsz = <span class="number">1024</span></span><br><span class="line">    steps = x_tr.shape[<span class="number">0</span>] / bsz</span><br><span class="line"></span><br><span class="line">    model.fit(x_tr, y_tr, callbacks=[CRPSCallback(validation=(x_val, y_val)), es, mc], epochs=<span class="number">100</span>, batch_size=bsz,</span><br><span class="line">              verbose=<span class="literal">False</span>)</span><br><span class="line">    model.load_weights(<span class="string">"best_model.h5"</span>)</span><br><span class="line"></span><br><span class="line">    y_pred = model.predict(x_val)</span><br><span class="line">    y_valid = y_val</span><br><span class="line">    y_true = np.clip(np.cumsum(y_valid, axis=<span class="number">1</span>), <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    y_pred = np.clip(np.cumsum(y_pred, axis=<span class="number">1</span>), <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    val_s = ((y_true - y_pred) ** <span class="number">2</span>).sum(axis=<span class="number">1</span>).sum(axis=<span class="number">0</span>) / (<span class="number">199</span> * x_val.shape[<span class="number">0</span>])</span><br><span class="line">    crps = np.round(val_s, <span class="number">8</span>)</span><br><span class="line">    gc.collect()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> model, crps</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>Lgbmï¼š<br>é¢„æµ‹å¤šæ ‡ç­¾æ–¹æ³•ï¼šæœ€æœ¬è´¨çš„åŒºåˆ«åœ¨äºè¿™é‡Œçš„å¤šæ ‡ç­¾æ¦‚ç‡çš„å¹³æ»‘æ€ä¹ˆåšï¼Œç¬¬ä¸€ç§ç›´æ¥ç”¨lgbmçš„apiæ„å‘³ç€è®©ç¨‹åºè‡ªåŠ¨è¿›è¡Œå¹³æ»‘ï¼Œè€Œç¬¬äºŒç§æ‰‹åŠ¨å±•å¼€åˆ™åªé€šè¿‡å¾—åˆ°çš„é¢„æµ‹å€¼ï¼Œè‡ªå·±åˆ¶å®šè§„åˆ™å±•å¼€ï¼Œç¬¬ä¸‰ç§ä»‹äºä¸€äºŒä¸¤ç§ä¹‹é—´ï¼Œé€šè¿‡æ‰‹åŠ¨åˆ¶å®šåˆ†æ¡¶çš„è§„åˆ™ï¼Œåœ¨æ¯ä¸ªåˆ†æ¡¶ä¸­è‡ªåŠ¨è¿›è¡Œå¹³æ»‘ã€‚æœ€åé‡‡å–äº†ç¬¬ä¸€ç§æ–¹å¼ã€‚</p>
<ol>
<li><p>ç›´æ¥ç”¨lgbmçš„apiï¼š<a href="https://www.kaggle.com/enzoamp/nfl-lightgbm/code" target="_blank" rel="noopener">https://www.kaggle.com/enzoamp/nfl-lightgbm/code</a></p>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&apos;objective&apos;:&apos;multiclass&apos;,</span><br><span class="line">&quot;metric&quot;: &apos;multi_logloss&apos;,</span><br><span class="line">&apos;num_class&apos;: 199,</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç”¨LGBMRegressor,å¾—åˆ°é¢„æµ‹å€¼ååŠ å‡½æ•°å±•å¼€ï¼Œ <a href="https://www.kaggle.com/newbielch/lgbm-regression-view" target="_blank" rel="noopener">https://www.kaggle.com/newbielch/lgbm-regression-view</a><br><a href="https://www.kaggle.com/apiao1/model-lgbm-regression/notebook?scriptVersionId=23357454" target="_blank" rel="noopener">https://www.kaggle.com/apiao1/model-lgbm-regression/notebook?scriptVersionId=23357454</a><br>V4 cv:0.01360 lb:0.01412(ä¸åŠåŸæ–‡çš„æˆç»©ï¼ŒåŸæ–‡çš„cv0.01349,lb0.01401) åº”è¯¥è¿‡æ‹Ÿåˆå¾ˆä¸¥é‡ï¼Œè°ƒå‚åº”è¯¥æœ‰è¾ƒå¥½ç»“æœ</p>
</li>
<li><p>LGBMClassifier + å¹³æ»‘ï¼Œ <a href="https://www.kaggle.com/mrkmakr/lgbm-multiple-classifier" target="_blank" rel="noopener">https://www.kaggle.com/mrkmakr/lgbm-multiple-classifier</a><br><a href="https://www.kaggle.com/apiao1/model-lgbm-multipleclassifier?scriptVersionId=23397574" target="_blank" rel="noopener">https://www.kaggle.com/apiao1/model-lgbm-multipleclassifier?scriptVersionId=23397574</a><br>V7 æ•ˆæœä¸å¥½ï¼Œcv:0.020105, lb:0.02159 ,çŒœæµ‹å“ªé‡Œæœ‰bug,(åŸæ–‡ï¼šcv:0.013140205432501861ï¼Œlb:0.01384)</p>
</li>
</ol>
</li>
</ol>
<ol start="3">
<li><p>RFï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">model = RandomForestRegressor(bootstrap=<span class="literal">False</span>, max_features=<span class="number">0.3</span>, min_samples_leaf=<span class="number">15</span>, min_samples_split=<span class="number">7</span>,n_estimators=<span class="number">250</span>, n_jobs=<span class="number">-1</span>, random_state=<span class="number">2019</span>)</span><br><span class="line">model.fit(tr_x, tr_y)</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>å…³äºensembleï¼š</p>
<ol>
<li>æ•ˆæœä¸ç†æƒ³ï¼Œé‡‡ç”¨NNå’Œlgbmçš„stackingåˆ†æ•°ä¸å•æ¨¡å‹NNç›¸åŒ</li>
<li>æœ€åçš„æäº¤ç”¨äº†ä¸¤ä¸ªç‰ˆæœ¬ï¼ŒNN-ä¼ ç»Ÿçš„blending,NNå’Œlgb-ç®€å•çš„stacking</li>
</ol>
<h1 id="trick"><a href="#trick" class="headerlink" title="trick"></a>trick</h1><ol>
<li><p>æ¨è¿›è·ç¦»ï¼ˆYardsï¼‰ä¸€å®šå°äºæ­¤æ—¶è·ç¦»å¾—åˆ†çš„è·ç¦»(Yards_limit)ï¼Œæ®æ­¤è¿›è¡ŒåéªŒçš„å¤„ç†</p>
</li>
<li><p>å¯¹è®­ç»ƒé›†ç»Ÿè®¡å‘ç°æ ·æœ¬æ ‡ç­¾çš„åˆ†å¸ƒä¸º-14è‡³99ï¼Œåœ¨-99è‡³-14åŒºé—´æ²¡æœ‰ä»»ä½•æ­£ä¾‹æ ·æœ¬ï¼Œå›ºæŠŠé¢„æµ‹ç±»åˆ«æ ‡ç­¾ç¼©å°è‡³-14åˆ°99çš„èŒƒå›´å†…</p>
</li>
<li><p>NNå¯¹æ•°æ®çš„å˜åŒ–å¾ˆæ•æ„Ÿï¼Œæ‰€ä»¥å¯ä»¥å°è¯•å¤šæ¬¡kæŠ˜çš„æ•°æ®åˆ†å‰²ï¼Œç”¨ä¸åŒçš„éšæœºæ•°ç§å­å»åšï¼Œæœ¬åœ°å¾—åˆ°çš„cvæ›´ä½</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">losses = []</span><br><span class="line">  models = []</span><br><span class="line">  mean_crps_csv = []</span><br><span class="line">   </span><br><span class="line">  <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">      kfold = KFold(<span class="number">9</span>, random_state=<span class="number">2019</span> + <span class="number">17</span> * k, shuffle=<span class="literal">True</span>)</span><br><span class="line">      j = <span class="number">0</span></span><br><span class="line">      crps_csv = []</span><br><span class="line">      <span class="keyword">for</span> k_fold, (tr_inds, val_inds) <span class="keyword">in</span> enumerate(kfold.split(yards)):</span><br><span class="line">          j += <span class="number">1</span></span><br><span class="line">          <span class="keyword">if</span> j &gt; <span class="number">3</span>:</span><br><span class="line">              <span class="keyword">break</span></span><br><span class="line">          tr_x, tr_y = X[tr_inds], y[tr_inds]</span><br><span class="line">          val_x, val_y = X[val_inds], y[val_inds]</span><br><span class="line">          model, crps = get_model(tr_x, tr_y, val_x, val_y)</span><br><span class="line">          models.append(model)</span><br><span class="line">          <span class="comment"># print("the %d fold crps is %f" % ((k_fold + 1), crps))</span></span><br><span class="line">          crps_csv.append(crps)</span><br><span class="line">      mean_crps_csv.append(np.mean(crps_csv))</span><br><span class="line">      print(<span class="string">"9 folder crps is %f"</span> % np.mean(crps_csv))</span><br><span class="line">   </span><br><span class="line">  print(<span class="string">"mean crps is %f"</span> % np.mean(mean_crps_csv))</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç”¨è´å¶æ–¯è°ƒå‚æ•ˆæœæ¯”ä¼ ç»Ÿçš„ç½‘æ ¼å’Œä¼˜åŒ–åçš„å¯å‘å¼ç½‘æ ¼æ•ˆæœéƒ½è¦æ›´å¥½</p>
</li>
</ol>
<h1 id="What-didnâ€™t-work"><a href="#What-didnâ€™t-work" class="headerlink" title="What didnâ€™t work"></a>What didnâ€™t work</h1><ol>
<li>æ²¡æœ‰å°è¯•ç”¨CNNå¤„ç†ï¼ˆäº‹å®ä¸Šç¡®å®æœ‰æ•ˆï¼‰</li>
<li>åªè®¡ç®—äº†çƒå‘˜ä»¬çš„ç›¸å¯¹è·ç¦»ï¼Œæ²¡æœ‰å°†ä½ç½®å…³ç³»å’Œé€Ÿåº¦åŠ é€Ÿåº¦è½¬åŒ–æˆç›¸å¯¹å€¼ï¼Œåªæ˜¯åšäº†æ–¹å‘åº¦é‡ä¸Šçš„ç»Ÿä¸€</li>
<li>æ²¡æœ‰æ‰¾åˆ°ä¸€ä¸ªç¨³å®šçš„cvè¯„ä»·æ–¹å¼ï¼Œcvä¸lbä¹‹é—´å˜åŒ–ä¸ä¸€è‡´ï¼Œå¯¼è‡´åæœŸç­›é€‰ç‰¹å¾å¾ˆæ²¡è°±éå¸¸ä¹åŠ›</li>
<li>ä¸åŒå¹´ä»½çš„æ•°æ®æƒé‡ï¼Œ2018å¹´æ•°æ®æƒé‡é«˜äº2017å¹´æ•°æ®ã€‚</li>
<li>ä¸åŒçš„æ•°æ®åˆ’åˆ†æ–¹å¼ï¼Œå°è¯•æ ¹æ®æ¯”èµ›å¹´ä»½è¿›è¡ŒgroupKfold</li>
</ol>
<h1 id="Thinking"><a href="#Thinking" class="headerlink" title="Thinking"></a>Thinking</h1><ol>
<li>æ‰“kaggleç¡®å®è¦ç»„é˜Ÿï¼Œä¸€ä¸ªäººåˆè¦è°ƒæ¨¡å‹åˆè¦åšç‰¹å¾çœŸçš„å¤ªèŠ±ç²¾åŠ›äº†ï¼Œè€Œä¸”ç¼ºå°‘äººä¸€èµ·è®¨è®ºï¼ŒåæœŸæ€ç»´å°±å±€é™äº†ï¼Œä¸åˆ©äºæå‡</li>
<li>é˜Ÿå‹ä¹ŸæŒºé‡è¦çš„ï¼Œè¿™æ¬¡æ¯”èµ›çš„é˜Ÿå‹ç™½å¤©éƒ½åœ¨ä¸Šç­å¤ªå¿™äº†Orz</li>
<li>ä¸€ä¸ªå¥½çš„baselineèƒ½çœå»ä¸å°‘åŠŸå¤«ï¼Œç”±äºå‚åŠ çš„æ—©ï¼ˆè·ç»“æŸä¸€ä¸ªæœˆå¼€å§‹åšï¼‰ï¼Œä¸­é—´æ¢äº†å¥½å¤šbaselineæµªè´¹äº†å¾ˆå¤šæ—¶é—´ï¼Œæ¨èè·ç¦»ç»“æŸ14-21å¤©å¼€å§‹ä¸ºå®œ</li>
<li>ç‰¹å¾ä¸ºç‹</li>
<li>äº‹å…ˆæ‰¾åˆ°ä¸€ä¸ªå’Œlbå˜åŒ–ä¸€è‡´çš„cväº‹åŠåŠŸå€</li>
<li>kaggle çš„ä»£ç å·¥ç¨‹åŒ–æ€ç»´å®åœ¨å¤ªå¼±äº†ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯é¢å‘è¿‡ç¨‹ï¼Œæ”¹baselineçš„æ—¶å€™å®åœ¨å¤ªéš¾è¿‡äº†</li>
</ol>
<hr>
<p>ç®—æ˜¯kaggleçš„é¦–æˆ˜å§ï¼Œç¡®å®æŠ•å…¥äº†å¾ˆå¤šæ—¶é—´ï¼Œä¹‹å‰ä¸€ç›´å¤„äºé“¶ç‰Œï¼Œå¾ˆå¯æƒœlbæœ€åä¸€å¤©æ‰å‡ºäº†é“¶ç‰ŒåŒºï¼Œå°±å·®ä¸¤åï¼Œæœ€åä¸€å¤©ä¹Ÿå¥‹æˆ˜åˆ°æ·±å¤œï¼ˆç¬¬äºŒå¤©è¿˜è¦æ—©èµ·ç¡®å®šæœ€åçš„æäº¤ï¼‰ï¼ŒæŠŠæˆ‘èƒ½å°è¯•çš„éƒ½å°è¯•äº†ï¼Œç®—æ˜¯å°½äº†äººäº‹ï¼Œé™å¾…æœ€åçš„ç»“æœå§~</p>
<p>1æœˆ6æ—¥Bæ¦œæœ€åçš„ç»“æœï¼Œå±Šæ—¶å¤§å®¶ä¼šå¼€æºè‡ªå·±çš„ä»£ç ï¼Œåˆ°æ—¶å€™è¿›ä¸€æ­¥å¯¹ç…§ä»£ç å­¦ä¹ æå‡ï¼Œæ˜å¤©å¼€å§‹å’Œæ–°é˜Ÿå‹æ‰“æ–°çš„æ¯”èµ›å•¦</p>
<h1 id="å† å†›æ–¹æ¡ˆå°ç»“"><a href="#å† å†›æ–¹æ¡ˆå°ç»“" class="headerlink" title="å† å†›æ–¹æ¡ˆå°ç»“"></a>å† å†›æ–¹æ¡ˆå°ç»“</h1><p>åˆšçœ‹äº†å‡ ä¸ªé«˜åˆ†çš„æ–¹æ¡ˆï¼Œå…¶ä¸­å† å†›æ–¹æ¡ˆç”¨äº†CNNè¿›è¡Œå®ç°ï¼Œè€Œä¸”ä¸æ˜¯ä¼ ç»Ÿæ„ä¹‰ä¸Šå¯¹å›¾åƒè¿›è¡Œå¤„ç†ï¼Œä»¤äººå°è±¡æ·±åˆ»ã€‚<a href="https://www.kaggle.com/c/nfl-big-data-bowl-2020/discussion/119400" target="_blank" rel="noopener">https://www.kaggle.com/c/nfl-big-data-bowl-2020/discussion/119400</a></p>
<p>å†æ¢³ç†ä¸€éæ•´ä¸ªå¤§èµ›çš„åŠ¨æœºï¼š</p>
<ul>
<li>ä¸€ä¸ªå†²åˆºè€…ï¼Œå…¶ç›®æ ‡æ˜¯å°½å¯èƒ½å‘å‰å†²</li>
<li>11åè¯•å›¾é˜»æ­¢å†²é”‹é˜Ÿçš„é˜²å®ˆçƒå‘˜</li>
<li>å‰©ä¸‹çš„10åè¿›æ”»çƒå‘˜è¯•å›¾é˜»æ­¢é˜²å®ˆè€…é˜»æ­¢æˆ–åº”å¯¹å†²é”‹é˜Ÿå‘˜</li>
</ul>
<p>ä»ä¸­å¯ä»¥å¾—åˆ°å¯¹é¢„æµ‹ç»“æœå½±å“è¾ƒå¤§çš„æ’åºä¾æ¬¡ä¸ºï¼šrusher -&gt; defender -&gt; offenderã€‚ç”»å‡ºæŸä¸ªplayæ—¶åœºä¸Šé˜Ÿå‘˜çš„åˆ†å¸ƒå¦‚ä¸‹ï¼š<img src="https://apiao-1258505467.cos.ap-chengdu.myqcloud.com/blog_pic/kaggle/NFL/nfl_1.png" alt></p>
<p>åœ¨æ¯”èµ›çš„å‰æœŸåªè€ƒè™‘äº†rusherä¸defender çš„ç‰¹å¾ï¼Œé‚£ä¹ˆå®ƒçœ‹èµ·æ¥å°±åƒæ˜¯ä¸€ä¸ªç®€å•çš„æ¸¸æˆï¼Œå¦‚ä¸‹å›¾ï¼Œå…¶ä¸­ä¸€ä¸ªç©å®¶è¯•å›¾é€ƒè·‘ï¼Œè€Œå…¶ä»–11ä¸ªç©å®¶è¯•å›¾æŠ“ä½ä»–ã€‚æˆ‘ä»¬å‡è®¾åœ¨æ¯”èµ›å¼€å§‹æ—¶ï¼Œæ— è®ºé˜²å®ˆè€…çš„ä½ç½®å¦‚ä½•ï¼Œæ¯ä½é˜²å®ˆè€…éƒ½å°†é›†ä¸­ç²¾åŠ›å°½å¿«é˜»æ­¢è¿›æ”»è€…ï¼Œè€Œæ¯ä½é˜²å®ˆè€…éƒ½æœ‰æœºä¼šåšåˆ°è¿™ä¸€ç‚¹ã€‚é˜²å®ˆè€…é“²çƒçš„æœºä¼šï¼ˆä»¥åŠé“²çƒçš„ä¼°è®¡ä½ç½®ï¼‰å–å†³äºä»–ä»¬çš„ç›¸å¯¹ä½ç½®ï¼Œç§»åŠ¨é€Ÿåº¦å’Œè¿åŠ¨æ–¹å‘ã€‚é€šè¿‡ä½¿ç”¨ç›¸å¯¹ä½ç½®å’Œé€Ÿåº¦åœ¨å„ä¸ªé˜²å¾¡è€…ä¸Šè¿›è¡Œå·ç§¯çš„æƒ³æ³•ï¼Œç„¶ååœ¨é¡¶éƒ¨åº”ç”¨æ± åŒ–å‹ç¼©ã€‚</p>
<img src="https://apiao-1258505467.cos.ap-chengdu.myqcloud.com/blog_pic/kaggle/NFL/nfl_2.png ">

<p>ä¹‹ååŠ å…¥äº†é˜Ÿå‹ç›¸å…³çš„ç‰¹å¾ï¼Œä¹Ÿé‡‡ç”¨ç±»ä¼¼çš„å¤„ç†ã€‚</p>
<h3 id="æ¨¡å‹ç»“æ„"><a href="#æ¨¡å‹ç»“æ„" class="headerlink" title="æ¨¡å‹ç»“æ„"></a>æ¨¡å‹ç»“æ„</h3><p>æœ€ç»ˆçš„æ¨¡å‹ç»“æ„CNNå¦‚ä¸‹ï¼š</p>
<p><img src="https://apiao-1258505467.cos.ap-chengdu.myqcloud.com/blog_pic/kaggle/NFL/nfl_3.png" alt></p>
<p>å°†æ‰€æœ‰çš„æ•°æ®é‡å¡‘ä¸ºè¿›æ”»ä¸é˜²å®ˆçš„å¼ é‡ï¼Œä¸”ä»…ç”¨äº†5ä¸ªç›¸å…³çš„ç‰¹å¾ï¼Œåˆ†åˆ«æ˜¯ï¼šé˜²å®ˆæ–¹çš„åŠ é€Ÿåº¦ã€é˜²å®ˆæ–¹ç›¸å¯¹äºrusherçš„åŠ é€Ÿåº¦ã€ä½ç½®ï¼Œè¿›æ”»æ–¹ç›¸å¯¹äºé˜²å®ˆæ–¹çš„ä½ç½®ã€åŠ é€Ÿåº¦ã€‚è€ƒè™‘åˆ°å¦‚æ­¤å¤„ç†åæ•´ä¸ªåˆå§‹æ•°æ®é›†æ˜¯ä¸ª10*11*5çš„ä¸‰ç»´çŸ©é˜µï¼Œé€šè¿‡CNNçš„ç‰¹æ€§æ°åˆ°å¥½å¤„çš„è¿›è¡Œäº†å‹ç¼©ä¸Embedingã€‚</p>
<blockquote>
<p>So the first block of convolutions learns to work with defense-offense pairs of players, using geometric features relative to rusher. The combination of multiple layers and activations before pooling was important to capture the trends properly. The second block of convolutions learns the necessary information per defense player before the aggregation. And the third block simply consists of dense layers and the usual things around them. 3 out of 5 input vectors do not depend on the offense player, hence they are constant across â€œoffâ€ dimension of the tensor.</p>
</blockquote>
<p>åœ¨poolingéƒ¨åˆ†ç”¨çš„æ˜¯åŠ æƒç»„åˆï¼Œå³0.7*maxpooling + 0.3 * avgpooling</p>
<h3 id="æ•°æ®å¢å¼ºå’ŒTTA"><a href="#æ•°æ®å¢å¼ºå’ŒTTA" class="headerlink" title="æ•°æ®å¢å¼ºå’ŒTTA"></a>æ•°æ®å¢å¼ºå’ŒTTA</h3><p>å¯¹æˆ‘ä»¬æ¥è¯´çœŸæ­£æœ‰æ•ˆçš„æ–¹æ³•æ˜¯ä¸ºYåæ ‡æ·»åŠ å¢å¼ºå’ŒTTAã€‚æˆ‘ä»¬å‡è®¾åœ¨é•œåƒçš„ä¸–ç•Œä¸­ï¼Œè¿è¡Œå°†å…·æœ‰ç›¸åŒçš„ç»“æœã€‚å¯¹äºè®­ç»ƒï¼Œæˆ‘ä»¬åº”ç”¨50ï¼…å¢å¼ºæ¥ç¿»è½¬Yåæ ‡ï¼ˆä»¥åŠç”±æ­¤äº§ç”Ÿçš„æ‰€æœ‰å„ä¸ªç›¸å¯¹ç‰¹å¾ï¼‰ã€‚å¯¹äºTTAï¼Œæˆ‘ä»¬åšåŒæ ·çš„äº‹æƒ…ï¼Œæˆ‘ä»¬æœ‰50-50çš„ç¿»è½¬å’Œéç¿»è½¬æ¨è®ºæ··åˆã€‚</p>
<h3 id="ä»£ç ä¼˜åŒ–"><a href="#ä»£ç ä¼˜åŒ–" class="headerlink" title="ä»£ç ä¼˜åŒ–"></a>ä»£ç ä¼˜åŒ–</h3><p>æˆ‘ä»¬å¾ˆæ—©å°±å†³å®šæœ€å¥½åœ¨å†…æ ¸ä¸­è¿›è¡Œæ‰€æœ‰æ‹Ÿåˆï¼Œç‰¹åˆ«æ˜¯å› ä¸ºåœ¨é‡æ–°è¿è¡Œä¸­æˆ‘ä»¬è¿˜æœ‰2019å¹´å¯ç”¨çš„æ•°æ®ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¿˜å†³å®šæ—©ç‚¹èŠ±æ—¶é—´ä¼˜åŒ–è¿è¡Œæ—¶é—´ï¼Œå› ä¸ºæˆ‘ä»¬ä¹ŸçŸ¥é“ï¼Œåœ¨æ‹Ÿåˆç¥ç»ç½‘ç»œæ—¶ï¼Œç”¨ä¸åŒçš„ç§å­æ‰“åŒ…å¤šæ¬¡è¿è¡Œéå¸¸é‡è¦ï¼Œå› ä¸ºè¿™é€šå¸¸ä¼šæ˜¾ç€æé«˜å‡†ç¡®æ€§ï¼Œå¹¶æ¶ˆé™¤äº†ä¸€äº›è¿æ°”å› ç´ ã€‚</p>
<p>å¦‚ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬ä½¿ç”¨Pytorchè¿›è¡Œæ‹Ÿåˆã€‚Kaggleå†…æ ¸æœ‰2ä¸ªå…·æœ‰4ä¸ªå†…æ ¸çš„CPUï¼Œå…¶ä¸­ä¸¤ä¸ªå†…æ ¸æ˜¯çœŸå®å†…æ ¸ï¼Œå¦å¤–ä¸¤ä¸ªæ˜¯ç”¨äºè¶…çº¿ç¨‹çš„è™šæ‹Ÿå†…æ ¸ã€‚ä¸€æ¬¡è¿è¡Œä½¿ç”¨æ‰€æœ‰4ä¸ªå†…æ ¸æ—¶ï¼Œå°±è¿è¡Œæ—¶è€Œè¨€ï¼Œå®ƒå¹¶ä¸æ˜¯æœ€ä½³é€‰æ‹©ï¼Œå› ä¸ºæ‚¨æ— æ³•åœ¨åˆé€‚çš„æƒ…å†µä¸‹å¯¹æ¯ä¸ªæ“ä½œè¿›è¡Œå¤šå¤„ç†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯ç¦ç”¨Pythonçš„æ‰€æœ‰å¤šçº¿ç¨‹å’Œå¤šå¤„ç†ï¼ˆMKLï¼ŒPytorchç­‰ï¼‰ï¼Œå¹¶åœ¨bagçº§åˆ«ä¸Šè¿›è¡Œæ‰‹åŠ¨å¤šå¤„ç†ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åŒæ—¶æ‹Ÿåˆ4ä¸ªæ¨¡å‹ï¼Œä¸åœ¨æ‰€æœ‰4ä¸ªå†…æ ¸ä¸Šæ‹Ÿåˆå•ä¸ªæ¨¡å‹ç›¸æ¯”ï¼Œå¯ä»¥è·å¾—æ›´å¤šçš„è¿è¡Œæ—¶é—´ã€‚</p>
<p>æˆ‘ä»¬çš„æœ€ç»ˆæ½œè‰‡æ¯ä¸ªä¿å®ˆåœ°é€‚åˆ8ä¸ªæ¨¡å‹ï¼Œæ½œè‰‡çš„æ€»è¿è¡Œæ—¶é—´ä½äº8500ç§’ã€‚</p>
<h3 id="CNNä¼ªä»£ç "><a href="#CNNä¼ªä»£ç " class="headerlink" title="CNNä¼ªä»£ç "></a>CNNä¼ªä»£ç </h3><p>è¯„è®ºéƒ¨åˆ†çš„ä¼ªä»£ç ï¼Œ<del>æºä»£ç å°šæœªå¼€æº</del>ï¼Œå·²å¼€æºï¼Œè§æ›´æ–°éƒ¨åˆ†ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">inputdenseplayers = Input(shape=(<span class="number">11</span>,<span class="number">10</span>,<span class="number">10</span>), name = <span class="string">"numericalplayersfeature_input"</span>)</span><br><span class="line"></span><br><span class="line">x = Conv2D(<span class="number">128</span>, kernelsize=(<span class="number">1</span>,<span class="number">1</span>), strides=(<span class="number">1</span>,<span class="number">1</span>), activation=<span class="literal">None</span>)(inputdense_players)</span><br><span class="line"></span><br><span class="line">x = Activation(<span class="string">'relu'</span>)(x)</span><br><span class="line"></span><br><span class="line">x = Conv2D(<span class="number">160</span>, kernel_size=(<span class="number">1</span>,<span class="number">1</span>), strides=(<span class="number">1</span>,<span class="number">1</span>), activation=<span class="literal">None</span>)(x)</span><br><span class="line"></span><br><span class="line">x = Activation(<span class="string">'relu'</span>)(x)</span><br><span class="line"></span><br><span class="line">x = Conv2D(<span class="number">128</span>, kernel_size=(<span class="number">1</span>,<span class="number">1</span>), strides=(<span class="number">1</span>,<span class="number">1</span>), activation=<span class="literal">None</span>)(x)</span><br><span class="line"></span><br><span class="line">x = Activation(<span class="string">'relu'</span>)(x)</span><br><span class="line"></span><br><span class="line">xmax = MaxPooling2D(pool_size=(<span class="number">1</span>,<span class="number">10</span>))(x)</span><br><span class="line"></span><br><span class="line">xmax = Lambda(<span class="keyword">lambda</span> x1 : x1*<span class="number">0.3</span>)(xmax)</span><br><span class="line"></span><br><span class="line">xavg = AvgPool2D(pool_size=(<span class="number">1</span>,<span class="number">10</span>))(x)</span><br><span class="line"></span><br><span class="line">xavg = Lambda(<span class="keyword">lambda</span> x1 : x1*<span class="number">0.7</span>)(xavg)</span><br><span class="line"></span><br><span class="line">x = Add()([xmax, xavg])</span><br><span class="line"></span><br><span class="line">x = Lambda(<span class="keyword">lambda</span> y : K.squeeze(y,<span class="number">2</span>))(x)</span><br><span class="line"></span><br><span class="line">x = Conv1D(<span class="number">128</span>, kernel_size=<span class="number">1</span>, strides=<span class="number">1</span>, activation=<span class="literal">None</span>)(x)</span><br><span class="line"></span><br><span class="line">x = Activation(<span class="string">'relu'</span>)(x)</span><br><span class="line"></span><br><span class="line">x = BatchNormalization()(x)</span><br><span class="line"></span><br><span class="line">x = Conv1D(<span class="number">160</span>, kernel_size=<span class="number">1</span>, strides=<span class="number">1</span>, activation=<span class="literal">None</span>)(x)</span><br><span class="line"></span><br><span class="line">x = Activation(<span class="string">'relu'</span>)(x)</span><br><span class="line"></span><br><span class="line">x = BatchNormalization()(x)</span><br><span class="line"></span><br><span class="line">x = Conv1D(<span class="number">96</span>, kernel_size=<span class="number">1</span>, strides=<span class="number">1</span>, activation=<span class="literal">None</span>)(x)</span><br><span class="line"></span><br><span class="line">x = Activation(<span class="string">'relu'</span>)(x)</span><br><span class="line"></span><br><span class="line">x = BatchNormalization()(x)</span><br><span class="line"></span><br><span class="line">xmax = MaxPooling1D(pool_size=<span class="number">11</span>)(x)</span><br><span class="line"></span><br><span class="line">xmax = Lambda(<span class="keyword">lambda</span> x1 : x1*<span class="number">0.3</span>)(xmax)</span><br><span class="line"></span><br><span class="line">xavg = AvgPool1D(pool_size=<span class="number">11</span>)(x)</span><br><span class="line"></span><br><span class="line">xavg = Lambda(<span class="keyword">lambda</span> x1 : x1*<span class="number">0.7</span>)(xavg)</span><br><span class="line"></span><br><span class="line">x = Add()([xmax, xavg])</span><br><span class="line"></span><br><span class="line">x = Lambda(<span class="keyword">lambda</span> y : K.squeeze(y,<span class="number">1</span>))(x)</span><br><span class="line"></span><br><span class="line">x = Dense(<span class="number">96</span>)(x)</span><br><span class="line"></span><br><span class="line">x = Activation(<span class="string">'relu'</span>)(x)</span><br><span class="line"></span><br><span class="line">x = BatchNormalization()(x)</span><br><span class="line"></span><br><span class="line">x = Dense(<span class="number">256</span>, activation=<span class="string">"relu"</span>)(x)</span><br><span class="line"></span><br><span class="line">x = Activation(<span class="string">'relu'</span>)(x)</span><br><span class="line"></span><br><span class="line">x = BatchNormalization()(x)</span><br><span class="line"></span><br><span class="line">outreg = Dense(<span class="number">1</span>, activation=<span class="string">'relu'</span>, name = <span class="string">"mainop_2"</span>)(x)</span><br><span class="line"></span><br><span class="line">outsoft = Dense(<span class="number">199</span>, activation=<span class="string">'softmax'</span>, name = <span class="string">"mainop_1"</span>)(x)</span><br><span class="line"></span><br><span class="line">model = Model(inputs = [inputdenseplayers], outputs = [outsoft, outreg])</span><br></pre></td></tr></table></figure>

<ul>
<li>we have another BN after the first pooling and before the first Conv1D</li>
<li>The Conv1D dimensions are 160-96-96 (I wrote that wrongly below)</li>
<li>After the very last linear layer we have Relu-LayerNorm-Dropout(0.3)</li>
<li>There is no regression output (and loss is crps afterwards)</li>
</ul>
<p>å¯¹åº”ä¸Šé¢çš„ä¼ªä»£ç å’Œæ•´ä¸ªæ¨¡å‹çš„æ¶æ„ï¼Œå…¶ç»´åº¦å˜åŒ–å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://apiao-1258505467.cos.ap-chengdu.myqcloud.com/blog_pic/kaggle/NFL/NFL_CNN.jpeg" alt></p>
<h1 id="1-16æ›´æ–°"><a href="#1-16æ›´æ–°" class="headerlink" title="1.16æ›´æ–°"></a>1.16æ›´æ–°</h1><p>å† å†›æ–¹æ¡ˆçš„æºä»£ç å·²å¼€æºï¼š<a href="https://www.kaggle.com/philippsinger/nfl-playing-surface-analytics-the-zoo" target="_blank" rel="noopener">https://www.kaggle.com/philippsinger/nfl-playing-surface-analytics-the-zoo</a></p>
<p>çœŸçš„æ˜¯è®©äººè†œæ‹œçš„æ–¹æ¡ˆï¼Œé—æ†¾çš„æ˜¯ä»–ä»¬çš„æ–¹æ¡ˆåœ¨bæ¦œè¿è¡Œå¤±è´¥äº†ï¼Œæ²¡æœ‰æœ€ç»ˆæˆç»©ã€‚æ›´è®©æˆ‘æ„è¯†åˆ°kernal basedæ¯”èµ›ä»£ç é²æ£’æ€§çš„é‡è¦æ€§ã€‚</p>
<p>æœ€åçš„bæ¦œç»“æœä¹Ÿå‡ºæ¥äº†ï¼Œ6%é“œç‰Œï¼Œå¯æƒœäº†å·®ä¸€ç‚¹é“¶ç‰Œï¼Œå†æ¥å†å‰ğŸ’ª</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Apiao</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://Apiao-1.github.io/2020/01/09/2020-01-09/">https://Apiao-1.github.io/2020/01/09/2020-01-09/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Kaggle/">Kaggle</a></div><div class="social-share" data-disabled="diandian,google,facebook,twitter,douban,share"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/2020/03/26/2020-03-26/"><i class="fa fa-chevron-left">  </i><span>3.25é˜¿é‡Œç¬”è¯•çš„ä¸€äº›æ€è€ƒ</span></a></div><div class="next-post pull-right"><a href="/2019/12/31/2019-12-31/"><span>2019å¹´ç»ˆå¤ç›˜</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: 'baf14b2c923df40b37c8',
  clientSecret: '989e5490466533378766304b304fa51a747285aa',
  repo: 'apiao-1.github.io',
  owner: 'Apiao-1',
  admin: 'Apiao-1',
  id: md5(decodeURI(location.pathname)),
  language: ''
})
gitalk.render('gitalk-container')</script></div></div><footer class="footer-bg" style="background-image: url(https://apiao-1258505467.cos.ap-chengdu.myqcloud.com/blog_pic/css_img/article3.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2020 By Apiao</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">ä¸€ç›´å¯»æ‰¾é“è·¯çš„äººæœ€åä¼šæ¶èµ·æ¡¥æ¢</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>